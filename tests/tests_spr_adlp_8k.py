"""Module for testing SPR_to_ADLP_8K.py Script"""

from unittest import TestCase
from unittest.mock import MagicMock, patch
from script_spr_to_adlp_8k.SPR_to_ADLP_8K import spr_create_dot_upload_file
# from script_spr_to_adlp_not_8k.Cli import main
import pandas as pd
from click.testing import CliRunner
import numpy as np


class SPR_to_ADLP_8K_Cli(TestCase):
    """Unit tests for invoking SPR_to_ADLP_8K.py Script using Click"""

    @classmethod
    def setUpClass(cls) -> None:

        cls.df_ss_txt_test = pd.DataFrame({'Curve markers': {0: np.NaN, 1: np.NaN, 2: np.NaN, 3: np.NaN, 4: np.NaN, 5:
            np.NaN, 6: np.NaN, 7: np.NaN, 8: np.NaN, 9: np.NaN, 10: np.NaN, 11: np.NaN, 12: np.NaN, 13: np.NaN, 14:
                                                                 np.NaN, 15: np.NaN, 16: np.NaN, 17: np.NaN, 18: np.NaN,
                                                             19: np.NaN, 20: np.NaN, 21: np.NaN, 22: np.NaN, 23:
                                                                 np.NaN, 24: np.NaN, 25: np.NaN, 26: np.NaN, 27: np.NaN,
                                                             28: np.NaN, 29: np.NaN, 30: np.NaN, 31: np.NaN, 32:
                                                                 np.NaN, 33: np.NaN, 34: np.NaN, 35: np.NaN, 36: np.NaN,
                                                             37: np.NaN, 38: np.NaN, 39: np.NaN, 40: np.NaN, 41:
                                                                 np.NaN, 42: np.NaN, 43: np.NaN, 44: np.NaN, 45: np.NaN,
                                                             46: np.NaN, 47: np.NaN},
                                           'Channel': {0: 1, 1: 2, 2: 3, 3: 4, 4: 5, 5: 6, 6: 7, 7: 8, 8: 1, 9: 2,
                                                       10: 3, 11: 4, 12: 5, 13: 6, 14: 7,
                                                       15: 8, 16: 1, 17: 2, 18: 3, 19: 4, 20: 5, 21: 6, 22: 7, 23: 8,
                                                       24: 1, 25: 2, 26: 3, 27: 4,
                                                       28: 5, 29: 6, 30: 7, 31: 8, 32: 1, 33: 2, 34: 3, 35: 4, 36: 5,
                                                       37: 6, 38: 7, 39: 8, 40: 1,
                                                       41: 2, 42: 3, 43: 4, 44: 5, 45: 6, 46: 7, 47: 8},
                                           'Immobilized ligand': {0: 'TEST_LIGAND', 1: 'TEST_LIGAND', 2: 'TEST_LIGAND',
                                                                  3: 'TEST_LIGAND',
                                                                  4: 'TEST_LIGAND', 5: 'TEST_LIGAND', 6: 'TEST_LIGAND',
                                                                  7: 'TEST_LIGAND', 8: 'TEST_LIGAND', 9: 'TEST_LIGAND',
                                                                  10: 'TEST_LIGAND',
                                                                  11: 'TEST_LIGAND', 12: 'TEST_LIGAND',
                                                                  13: 'TEST_LIGAND', 14: 'TEST_LIGAND',
                                                                  15: 'TEST_LIGAND',
                                                                  16: 'TEST_LIGAND',
                                                                  17: 'TEST_LIGAND', 18: 'TEST_LIGAND',
                                                                  19: 'TEST_LIGAND', 20: 'TEST_LIGAND',
                                                                  21: 'TEST_LIGAND',
                                                                  22: 'TEST_LIGAND',
                                                                  23: 'TEST_LIGAND', 24: 'TEST_LIGAND',
                                                                  25: 'TEST_LIGAND', 26: 'TEST_LIGAND',
                                                                  27: 'TEST_LIGAND',
                                                                  28: 'TEST_LIGAND',
                                                                  29: 'TEST_LIGAND', 30: 'TEST_LIGAND',
                                                                  31: 'TEST_LIGAND', 32: 'TEST_LIGAND',
                                                                  33: 'TEST_LIGAND',
                                                                  34: 'TEST_LIGAND',
                                                                  35: 'TEST_LIGAND', 36: 'TEST_LIGAND',
                                                                  37: 'TEST_LIGAND', 38: 'TEST_LIGAND',
                                                                  39: 'TEST_LIGAND',
                                                                  40: 'TEST_LIGAND',
                                                                  41: 'TEST_LIGAND', 42: 'TEST_LIGAND',
                                                                  43: 'TEST_LIGAND', 44: 'TEST_LIGAND',
                                                                  45: 'TEST_LIGAND',
                                                                  46: 'TEST_LIGAND',
                                                                  47: 'TEST_LIGAND'},
                                           'Affinity model': {0: 'Steady state affinity', 1: 'Steady state affinity',
                                                              2: 'Steady state affinity',
                                                              3: 'Steady state affinity', 4: 'Steady state affinity',
                                                              5: 'Steady state affinity',
                                                              6: 'Steady state affinity', 7: 'Steady state affinity',
                                                              8: 'Steady state affinity',
                                                              9: 'Steady state affinity', 10: 'Steady state affinity',
                                                              11: 'Steady state affinity',
                                                              12: 'Steady state affinity', 13: 'Steady state affinity',
                                                              14: 'Steady state affinity',
                                                              15: 'Steady state affinity', 16: 'Steady state affinity',
                                                              17: 'Steady state affinity',
                                                              18: 'Steady state affinity', 19: 'Steady state affinity',
                                                              20: 'Steady state affinity',
                                                              21: 'Steady state affinity', 22: 'Steady state affinity',
                                                              23: 'Steady state affinity',
                                                              24: 'Steady state affinity', 25: 'Steady state affinity',
                                                              26: 'Steady state affinity',
                                                              27: 'Steady state affinity', 28: 'Steady state affinity',
                                                              29: 'Steady state affinity',
                                                              30: 'Steady state affinity', 31: 'Steady state affinity',
                                                              32: 'Steady state affinity',
                                                              33: 'Steady state affinity', 34: 'Steady state affinity',
                                                              35: 'Steady state affinity',
                                                              36: 'Steady state affinity', 37: 'Steady state affinity',
                                                              38: 'Steady state affinity',
                                                              39: 'Steady state affinity', 40: 'Steady state affinity',
                                                              41: 'Steady state affinity',
                                                              42: 'Steady state affinity', 43: 'Steady state affinity',
                                                              44: 'Steady state affinity',
                                                              45: 'Steady state affinity', 46: 'Steady state affinity',
                                                              47: 'Steady state affinity'},
                                           'Kinetics model': {0: np.NaN, 1: np.NaN, 2: np.NaN, 3: np.NaN, 4: np.NaN,
                                                              5: np.NaN, 6: np.NaN, 7: np.NaN,
                                                              8: np.NaN, 9: np.NaN, 10: np.NaN, 11: np.NaN, 12: np.NaN,
                                                              13: np.NaN, 14: np.NaN,
                                                              15: np.NaN, 16: np.NaN, 17: np.NaN, 18: np.NaN,
                                                              19: np.NaN, 20: np.NaN, 21: np.NaN,
                                                              22: np.NaN, 23: np.NaN, 24: np.NaN, 25: np.NaN,
                                                              26: np.NaN, 27: np.NaN, 28: np.NaN,
                                                              29: np.NaN, 30: np.NaN, 31: np.NaN, 32: np.NaN,
                                                              33: np.NaN, 34: np.NaN, 35: np.NaN,
                                                              36: np.NaN, 37: np.NaN, 38: np.NaN, 39: np.NaN,
                                                              40: np.NaN, 41: np.NaN, 42: np.NaN,
                                                              43: np.NaN, 44: np.NaN, 45: np.NaN, 46: np.NaN,
                                                              47: '1:1 binding'},
                                           'Affinity Chi': {0: 0.376, 1: 0.79, 2: 0.302, 3: 0.202, 4: 0.358, 5: 0.253,
                                                            6: 0.371, 7: 0.329, 8: np.NaN,
                                                            9: 3.43, 10: 8.86, 11: 0.106, 12: np.NaN, 13: 2.02,
                                                            14: np.NaN, 15: np.NaN, 16: 46.0,
                                                            17: 2.71, 18: 8.33, 19: 10.2, 20: 0.31, 21: 4.28,
                                                            22: np.NaN, 23: 5.95, 24: 6.26,
                                                            25: np.NaN, 26: np.NaN, 27: np.NaN, 28: np.NaN, 29: np.NaN,
                                                            30: 0.023, 31: 0.851,
                                                            32: np.NaN, 33: 2.48, 34: 0.596, 35: 1.91, 36: 1.13,
                                                            37: 5.23, 38: 0.7809999999999999,
                                                            39: np.NaN, 40: np.NaN, 41: np.NaN, 42: np.NaN, 43: 6.85,
                                                            44: 1.83, 45: 2.15, 46: np.NaN,
                                                            47: 0.0179},
                                           'Analyte 1 Solution': {0: 'BRD-6011_1', 1: 'BRD-6011_2', 2: 'BRD-6011_3',
                                                                  3: 'BRD-6011_4', 4: 'BRD-6011_5',
                                                                  5: 'BRD-6011_6', 6: 'BRD-6011_7', 7: 'BRD-6011_8',
                                                                  8: 'BRD-5709_9', 9: 'BRD-5654_10',
                                                                  10: 'BRD-5726_11', 11: 'BRD-5658_12',
                                                                  12: 'BRD-5708_13', 13: 'BRD-5681_14',
                                                                  14: 'BRD-5702_15', 15: 'BRD-5685_16',
                                                                  16: 'BRD-5725_17', 17: 'BRD-5711_18',
                                                                  18: 'BRD-5728_19', 19: 'BRD-5664_20',
                                                                  20: 'BRD-5627_21', 21: 'BRD-5669_22',
                                                                  22: 'BRD-5650_23', 23: 'BRD-5674_24',
                                                                  24: 'BRD-5690_25', 25: 'BRD-5655_26',
                                                                  26: 'BRD-5694_27', 27: 'BRD-5659_28',
                                                                  28: 'BRD-4761_29', 29: 'BRD-5683_30',
                                                                  30: 'BRD-5703_31', 31: 'BRD-5638_32',
                                                                  32: 'BRD-5721_33', 33: 'BRD-5660_34',
                                                                  34: 'BRD-5718_35', 35: 'BRD-5665_36',
                                                                  36: 'BRD-5645_37', 37: 'BRD-5669_38',
                                                                  38: 'BRD-5651_39', 39: 'BRD-5641_40',
                                                                  40: 'BRD-5691_41', 41: 'BRD-5032_42',
                                                                  42: 'BRD-5737_43', 43: 'BRD-5676_44',
                                                                  44: 'BRD-5698_45', 45: 'BRD-5682_46',
                                                                  46: 'BRD-5704_47', 47: 'BRD-5640_48'},
                                           'KD (M)': {0: 5.42e-06, 1: 5.03e-06, 2: 5.31e-06, 3: 4.37e-06, 4: 4.58e-06,
                                                      5: 5.34e-06, 6: 4.46e-06,
                                                      7: 5.21e-06, 8: np.NaN, 9: 2.81e-07, 10: 1.64e-06, 11: 4.21e-06,
                                                      12: np.NaN, 13: 1.03e-05,
                                                      14: np.NaN, 15: np.NaN, 16: 2.74e-07, 17: 3.48e-07, 18: 8.29e-07,
                                                      19: 5.46e-06, 20: 1.32e-05,
                                                      21: 7.179999999999998e-07, 22: np.NaN, 23: 7.42e-06, 24: 9.43e-07,
                                                      25: np.NaN, 26: np.NaN,
                                                      27: np.NaN, 28: np.NaN, 29: np.NaN, 30: 0.000195, 31: 0.00027,
                                                      32: np.NaN, 33: 1.31e-06,
                                                      34: 5.79e-07, 35: 8.05e-07, 36: 1.41e-06, 37: 1.43e-06,
                                                      38: 5.04e-06, 39: np.NaN, 40: np.NaN,
                                                      41: np.NaN, 42: np.NaN, 43: 1.36e-06, 44: 7.690000000000002e-07,
                                                      45: 4.32e-07, 46: np.NaN,
                                                      47: 1.55e-06},
                                           'Rmax (RU)': {0: 36.9, 1: 36.2, 2: 36.3, 3: 33.5, 4: 34.9, 5: 38.0, 6: 37.2,
                                                         7: 36.7, 8: np.NaN,
                                                         9: 25.8, 10: 58.1, 11: 20.0, 12: np.NaN, 13: 75.5, 14: np.NaN,
                                                         15: np.NaN, 16: 52.7,
                                                         17: 29.9, 18: 69.4, 19: 50.6, 20: 66.5, 21: 53.8, 22: np.NaN,
                                                         23: 39.0, 24: 46.3,
                                                         25: np.NaN, 26: np.NaN, 27: np.NaN, 28: np.NaN, 29: np.NaN,
                                                         30: 129.4, 31: 254.0,
                                                         32: np.NaN, 33: 32.2, 34: 19.5, 35: 14.8, 36: 12.8, 37: 46.3,
                                                         38: 39.8, 39: np.NaN,
                                                         40: np.NaN, 41: np.NaN, 42: np.NaN, 43: 41.8, 44: 34.0,
                                                         45: 48.0, 46: np.NaN, 47: 18.0},
                                           'offset (RU)': {0: 1.0, 1: 2.5, 2: 1.5, 3: 1.8, 4: 1.8, 5: 1.5, 6: 1.4,
                                                           7: 0.9, 8: np.NaN, 9: -6.4,
                                                           10: 2.3, 11: 1.5, 12: np.NaN, 13: 0.8, 14: np.NaN,
                                                           15: np.NaN, 16: -9.1, 17: 0.0,
                                                           18: 1.9, 19: 3.3, 20: 0.1, 21: 0.0, 22: np.NaN, 23: 3.0,
                                                           24: 3.9, 25: np.NaN, 26: np.NaN,
                                                           27: np.NaN, 28: np.NaN, 29: np.NaN, 30: -0.5, 31: 2.1,
                                                           32: np.NaN, 33: 0.1, 34: 0.0,
                                                           35: -1.2, 36: 1.6, 37: 0.0, 38: 0.4, 39: np.NaN, 40: np.NaN,
                                                           41: np.NaN, 42: np.NaN,
                                                           43: 1.6, 44: 0.0, 45: 0.0, 46: np.NaN, 47: -0.8},
                                           'ka (1/Ms)': {0: np.NaN, 1: np.NaN, 2: np.NaN, 3: np.NaN, 4: np.NaN,
                                                         5: np.NaN, 6: np.NaN, 7: np.NaN,
                                                         8: np.NaN, 9: np.NaN, 10: np.NaN, 11: np.NaN, 12: np.NaN,
                                                         13: np.NaN, 14: np.NaN,
                                                         15: np.NaN, 16: np.NaN, 17: np.NaN, 18: np.NaN, 19: np.NaN,
                                                         20: np.NaN, 21: np.NaN,
                                                         22: np.NaN, 23: np.NaN, 24: np.NaN, 25: np.NaN, 26: np.NaN,
                                                         27: np.NaN, 28: np.NaN,
                                                         29: np.NaN, 30: np.NaN, 31: np.NaN, 32: np.NaN, 33: np.NaN,
                                                         34: np.NaN, 35: np.NaN,
                                                         36: np.NaN, 37: np.NaN, 38: np.NaN, 39: np.NaN, 40: np.NaN,
                                                         41: np.NaN, 42: np.NaN,
                                                         43: np.NaN, 44: np.NaN, 45: np.NaN, 46: np.NaN, 47: 25700.0},
                                           'kd (1/s)': {0: np.NaN, 1: np.NaN, 2: np.NaN, 3: np.NaN, 4: np.NaN,
                                                        5: np.NaN, 6: np.NaN, 7: np.NaN,
                                                        8: np.NaN, 9: np.NaN, 10: np.NaN, 11: np.NaN, 12: np.NaN,
                                                        13: np.NaN, 14: np.NaN, 15: np.NaN,
                                                        16: np.NaN, 17: np.NaN, 18: np.NaN, 19: np.NaN, 20: np.NaN,
                                                        21: np.NaN, 22: np.NaN,
                                                        23: np.NaN, 24: np.NaN, 25: np.NaN, 26: np.NaN, 27: np.NaN,
                                                        28: np.NaN, 29: np.NaN,
                                                        30: np.NaN, 31: np.NaN, 32: np.NaN, 33: np.NaN, 34: np.NaN,
                                                        35: np.NaN, 36: np.NaN,
                                                        37: np.NaN, 38: np.NaN, 39: np.NaN, 40: np.NaN, 41: np.NaN,
                                                        42: np.NaN, 43: np.NaN,
                                                        44: np.NaN, 45: np.NaN, 46: np.NaN, 47: 0.00387},
                                           'Cmpd_Run_Order': {0: 1, 1: 2, 2: 3, 3: 4, 4: 5, 5: 6, 6: 7, 7: 8, 8: 9,
                                                              9: 10, 10: 11, 11: 12, 12: 13,
                                                              13: 14, 14: 15, 15: 16, 16: 17, 17: 18, 18: 19, 19: 20,
                                                              20: 21, 21: 22, 22: 23,
                                                              23: 24, 24: 25, 25: 26, 26: 27, 27: 28, 28: 29, 29: 30,
                                                              30: 31, 31: 32, 32: 33,
                                                              33: 34, 34: 35, 35: 36, 36: 37, 37: 38, 38: 39, 39: 40,
                                                              40: 41, 41: 42, 42: 43,
                                                              43: 44, 44: 45, 45: 46, 46: 47, 47: 48},
                                           'Steady_State_Img': {0: 'BRD-6011_1_200212_7260_affinity_17_1.png',
                                                                1: 'BRD-6011_2_200212_7260_affinity_17_2.png',
                                                                2: 'BRD-6011_3_200212_7260_affinity_17_3.png',
                                                                3: 'BRD-6011_4_200212_7260_affinity_17_4.png',
                                                                4: 'BRD-6011_5_200212_7260_affinity_17_5.png',
                                                                5: 'BRD-6011_6_200212_7260_affinity_17_6.png',
                                                                6: 'BRD-6011_7_200212_7260_affinity_17_7.png',
                                                                7: 'BRD-6011_8_200212_7260_affinity_17_8.png',
                                                                8: 'BRD-5709_9_200212_7260_affinity_17_9.png',
                                                                9: 'BRD-5654_10_200212_7260_affinity_17_10.png',
                                                                10: 'BRD-5726_11_200212_7260_affinity_17_11.png',
                                                                11: 'BRD-5658_12_200212_7260_affinity_17_12.png',
                                                                12: 'BRD-5708_13_200212_7260_affinity_17_13.png',
                                                                13: 'BRD-5681_14_200212_7260_affinity_17_14.png',
                                                                14: 'BRD-5702_15_200212_7260_affinity_17_15.png',
                                                                15: 'BRD-5685_16_200212_7260_affinity_17_16.png',
                                                                16: 'BRD-5725_17_200212_7260_affinity_17_17.png',
                                                                17: 'BRD-5711_18_200212_7260_affinity_17_18.png',
                                                                18: 'BRD-5728_19_200212_7260_affinity_17_19.png',
                                                                19: 'BRD-5664_20_200212_7260_affinity_17_20.png',
                                                                20: 'BRD-5627_21_200212_7260_affinity_17_21.png',
                                                                21: 'BRD-5669_22_200212_7260_affinity_17_22.png',
                                                                22: 'BRD-5650_23_200212_7260_affinity_17_23.png',
                                                                23: 'BRD-5674_24_200212_7260_affinity_17_24.png',
                                                                24: 'BRD-5690_25_200212_7260_affinity_17_25.png',
                                                                25: 'BRD-5655_26_200212_7260_affinity_17_26.png',
                                                                26: 'BRD-5694_27_200212_7260_affinity_17_27.png',
                                                                27: 'BRD-5659_28_200212_7260_affinity_17_28.png',
                                                                28: 'BRD-4761_29_200212_7260_affinity_17_29.png',
                                                                29: 'BRD-5683_30_200212_7260_affinity_17_30.png',
                                                                30: 'BRD-5703_31_200212_7260_affinity_17_31.png',
                                                                31: 'BRD-5638_32_200212_7260_affinity_17_32.png',
                                                                32: 'BRD-5721_33_200212_7260_affinity_17_33.png',
                                                                33: 'BRD-5660_34_200212_7260_affinity_17_34.png',
                                                                34: 'BRD-5718_35_200212_7260_affinity_17_35.png',
                                                                35: 'BRD-5665_36_200212_7260_affinity_17_36.png',
                                                                36: 'BRD-5645_37_200212_7260_affinity_17_37.png',
                                                                37: 'BRD-5669_38_200212_7260_affinity_17_38.png',
                                                                38: 'BRD-5651_39_200212_7260_affinity_17_39.png',
                                                                39: 'BRD-5641_40_200212_7260_affinity_17_40.png',
                                                                40: 'BRD-5691_41_200212_7260_affinity_17_41.png',
                                                                41: 'BRD-5032_42_200212_7260_affinity_17_42.png',
                                                                42: 'BRD-5737_43_200212_7260_affinity_17_43.png',
                                                                43: 'BRD-5676_44_200212_7260_affinity_17_44.png',
                                                                44: 'BRD-5698_45_200212_7260_affinity_17_45.png',
                                                                45: 'BRD-5682_46_200212_7260_affinity_17_46.png',
                                                                46: 'BRD-5704_47_200212_7260_affinity_17_47.png',
                                                                47: 'BRD-5640_48_200212_7260_affinity_17_48.png',
                                                                }})

        cls.df_senso_txt_test = pd.DataFrame({'Kinetics model': {0: '1:1 binding', 1: '1:1 binding', 2: '1:1 binding',
                                                                 3: '1:1 binding', 4: '1:1 binding', 5: '1:1 binding',
                                                                 6: '1:1 binding', 7: '1:1 binding', 8: '1:1 binding',
                                                                 9: '1:1 binding', 10: '1:1 binding', 11: '1:1 binding',
                                                                 12: '1:1 binding', 13: '1:1 binding',
                                                                 14: '1:1 binding', 15: '1:1 binding',
                                                                 16: '1:1 binding', 17: '1:1 binding',
                                                                 18: '1:1 binding', 19: '1:1 binding',
                                                                 20: '1:1 binding', 21: '1:1 binding',
                                                                 22: '1:1 binding', 23: '1:1 binding',
                                                                 24: '1:1 binding', 25: '1:1 binding',
                                                                 26: '1:1 binding', 27: '1:1 binding',
                                                                 28: '1:1 binding', 29: '1:1 binding',
                                                                 30: '1:1 binding', 31: '1:1 binding',
                                                                 32: '1:1 binding', 33: '1:1 binding',
                                                                 34: '1:1 binding', 35: '1:1 binding',
                                                                 36: '1:1 binding', 37: '1:1 binding',
                                                                 38: '1:1 binding', 39: '1:1 binding',
                                                                 40: '1:1 binding', 41: '1:1 binding',
                                                                 42: '1:1 binding', 43: '1:1 binding',
                                                                 44: '1:1 binding', 45: '1:1 binding',
                                                                 46: '1:1 binding', 47: '1:1 binding'},
                                              'Curve markers': {0: np.NaN, 1: np.NaN, 2: np.NaN, 3: np.NaN, 4: np.NaN,
                                                                5: np.NaN, 6: np.NaN, 7: np.NaN, 8: np.NaN, 9: np.NaN,
                                                                10: np.NaN, 11: np.NaN, 12: np.NaN, 13: np.NaN,
                                                                14: np.NaN, 15: np.NaN, 16: np.NaN, 17: np.NaN,
                                                                18: np.NaN, 19: np.NaN, 20: np.NaN, 21: np.NaN,
                                                                22: np.NaN, 23: np.NaN, 24: np.NaN, 25: np.NaN,
                                                                26: np.NaN, 27: np.NaN, 28: np.NaN, 29: np.NaN,
                                                                30: np.NaN, 31: np.NaN, 32: np.NaN, 33: np.NaN,
                                                                34: np.NaN, 35: np.NaN, 36: np.NaN, 37: np.NaN,
                                                                38: np.NaN, 39: np.NaN, 40: np.NaN, 41: np.NaN,
                                                                42: np.NaN, 43: np.NaN, 44: np.NaN, 45: np.NaN,
                                                                46: np.NaN, 47: np.NaN},
                                              'Channel': {0: 1, 1: 2, 2: 3, 3: 4, 4: 5, 5: 6, 6: 7, 7: 8, 8: 1, 9: 2,
                                                          10: 3, 11: 4, 12: 5, 13: 6, 14: 7, 15: 8, 16: 1, 17: 2, 18: 3,
                                                          19: 4, 20: 5, 21: 6, 22: 7, 23: 8, 24: 1, 25: 2, 26: 3, 27: 4,
                                                          28: 5, 29: 6, 30: 7, 31: 8, 32: 1, 33: 2, 34: 3, 35: 4, 36: 5,
                                                          37: 6, 38: 7, 39: 8, 40: 1, 41: 2, 42: 3, 43: 4, 44: 5, 45: 6,
                                                          46: 7, 47: 8},
                                              'Immobilized ligand': {0: 'TEST_LIGAND', 1: 'TEST_LIGAND',
                                                                     2: 'TEST_LIGAND',
                                                                     3: 'TEST_LIGAND',
                                                                     4: 'TEST_LIGAND', 5: 'TEST_LIGAND',
                                                                     6: 'TEST_LIGAND',
                                                                     7: 'TEST_LIGAND',
                                                                     8: 'TEST_LIGAND', 9: 'TEST_LIGAND',
                                                                     10: 'TEST_LIGAND',
                                                                     11: 'TEST_LIGAND',
                                                                     12: 'TEST_LIGAND', 13: 'TEST_LIGAND',
                                                                     14: 'TEST_LIGAND',
                                                                     15: 'TEST_LIGAND',
                                                                     16: 'TEST_LIGAND', 17: 'TEST_LIGAND',
                                                                     18: 'TEST_LIGAND',
                                                                     19: 'TEST_LIGAND',
                                                                     20: 'TEST_LIGAND', 21: 'TEST_LIGAND',
                                                                     22: 'TEST_LIGAND',
                                                                     23: 'TEST_LIGAND',
                                                                     24: 'TEST_LIGAND', 25: 'TEST_LIGAND',
                                                                     26: 'TEST_LIGAND',
                                                                     27: 'TEST_LIGAND',
                                                                     28: 'TEST_LIGAND', 29: 'TEST_LIGAND',
                                                                     30: 'TEST_LIGAND',
                                                                     31: 'TEST_LIGAND',
                                                                     32: 'TEST_LIGAND', 33: 'TEST_LIGAND',
                                                                     34: 'TEST_LIGAND',
                                                                     35: 'TEST_LIGAND',
                                                                     36: 'TEST_LIGAND', 37: 'TEST_LIGAND',
                                                                     38: 'TEST_LIGAND',
                                                                     39: 'TEST_LIGAND',
                                                                     40: 'TEST_LIGAND', 41: 'TEST_LIGAND',
                                                                     42: 'TEST_LIGAND',
                                                                     43: 'TEST_LIGAND',
                                                                     44: 'TEST_LIGAND', 45: 'TEST_LIGAND',
                                                                     46: 'TEST_LIGAND',
                                                                     47: 'TEST_LIGAND'},
                                              'Kinetics Chi': {0: np.NaN, 1: np.NaN, 2: np.NaN, 3: np.NaN, 4: np.NaN,
                                                               5: np.NaN, 6: np.NaN, 7: np.NaN, 8: np.NaN, 9: np.NaN,
                                                               10: np.NaN, 11: np.NaN, 12: np.NaN, 13: np.NaN,
                                                               14: np.NaN, 15: np.NaN, 16: np.NaN, 17: np.NaN,
                                                               18: np.NaN, 19: np.NaN, 20: np.NaN, 21: np.NaN,
                                                               22: np.NaN, 23: np.NaN, 24: np.NaN, 25: np.NaN,
                                                               26: np.NaN, 27: np.NaN, 28: np.NaN, 29: np.NaN,
                                                               30: np.NaN, 31: np.NaN, 32: np.NaN, 33: np.NaN,
                                                               34: np.NaN, 35: np.NaN, 36: np.NaN, 37: np.NaN,
                                                               38: np.NaN, 39: np.NaN, 40: np.NaN, 41: np.NaN,
                                                               42: np.NaN, 43: np.NaN, 44: np.NaN, 45: np.NaN,
                                                               46: np.NaN, 47: 0.111},
                                              'ka': {0: np.NaN, 1: np.NaN, 2: np.NaN, 3: np.NaN, 4: np.NaN, 5: np.NaN,
                                                     6: np.NaN, 7: np.NaN, 8: np.NaN, 9: np.NaN, 10: np.NaN, 11: np.NaN,
                                                     12: np.NaN, 13: np.NaN, 14: np.NaN, 15: np.NaN, 16: np.NaN,
                                                     17: np.NaN, 18: np.NaN, 19: np.NaN, 20: np.NaN, 21: np.NaN,
                                                     22: np.NaN, 23: np.NaN, 24: np.NaN, 25: np.NaN, 26: np.NaN,
                                                     27: np.NaN, 28: np.NaN, 29: np.NaN, 30: np.NaN, 31: np.NaN,
                                                     32: np.NaN, 33: np.NaN, 34: np.NaN, 35: np.NaN, 36: np.NaN,
                                                     37: np.NaN, 38: np.NaN, 39: np.NaN, 40: np.NaN, 41: np.NaN,
                                                     42: np.NaN, 43: np.NaN, 44: np.NaN, 45: np.NaN, 46: np.NaN,
                                                     47: 26000.0},
                                              'kd': {0: np.NaN, 1: np.NaN, 2: np.NaN, 3: np.NaN, 4: np.NaN, 5: np.NaN,
                                                     6: np.NaN, 7: np.NaN, 8: np.NaN, 9: np.NaN, 10: np.NaN, 11: np.NaN,
                                                     12: np.NaN, 13: np.NaN, 14: np.NaN, 15: np.NaN, 16: np.NaN,
                                                     17: np.NaN, 18: np.NaN, 19: np.NaN, 20: np.NaN, 21: np.NaN,
                                                     22: np.NaN, 23: np.NaN, 24: np.NaN, 25: np.NaN, 26: np.NaN,
                                                     27: np.NaN, 28: np.NaN, 29: np.NaN, 30: np.NaN, 31: np.NaN,
                                                     32: np.NaN, 33: np.NaN, 34: np.NaN, 35: np.NaN, 36: np.NaN,
                                                     37: np.NaN, 38: np.NaN, 39: np.NaN, 40: np.NaN, 41: np.NaN,
                                                     42: np.NaN, 43: np.NaN, 44: np.NaN, 45: np.NaN, 46: np.NaN,
                                                     47: 0.004},
                                              'Rmax': {0: np.NaN, 1: np.NaN, 2: np.NaN, 3: np.NaN, 4: np.NaN, 5: np.NaN,
                                                       6: np.NaN, 7: np.NaN, 8: np.NaN, 9: np.NaN, 10: np.NaN,
                                                       11: np.NaN, 12: np.NaN, 13: np.NaN, 14: np.NaN, 15: np.NaN,
                                                       16: np.NaN, 17: np.NaN, 18: np.NaN, 19: np.NaN, 20: np.NaN,
                                                       21: np.NaN, 22: np.NaN, 23: np.NaN, 24: np.NaN, 25: np.NaN,
                                                       26: np.NaN, 27: np.NaN, 28: np.NaN, 29: np.NaN, 30: np.NaN,
                                                       31: np.NaN, 32: np.NaN, 33: np.NaN, 34: np.NaN, 35: np.NaN,
                                                       36: np.NaN, 37: np.NaN, 38: np.NaN, 39: np.NaN, 40: np.NaN,
                                                       41: np.NaN, 42: np.NaN, 43: np.NaN, 44: np.NaN, 45: np.NaN,
                                                       46: np.NaN, 47: 14.0},
                                              'tc': {0: np.NaN, 1: np.NaN, 2: np.NaN, 3: np.NaN, 4: np.NaN, 5: np.NaN,
                                                     6: np.NaN, 7: np.NaN, 8: np.NaN, 9: np.NaN, 10: np.NaN, 11: np.NaN,
                                                     12: np.NaN, 13: np.NaN, 14: np.NaN, 15: np.NaN, 16: np.NaN,
                                                     17: np.NaN, 18: np.NaN, 19: np.NaN, 20: np.NaN, 21: np.NaN,
                                                     22: np.NaN, 23: np.NaN, 24: np.NaN, 25: np.NaN, 26: np.NaN,
                                                     27: np.NaN, 28: np.NaN, 29: np.NaN, 30: np.NaN, 31: np.NaN,
                                                     32: np.NaN, 33: np.NaN, 34: np.NaN, 35: np.NaN, 36: np.NaN,
                                                     37: np.NaN, 38: np.NaN, 39: np.NaN, 40: np.NaN, 41: np.NaN,
                                                     42: np.NaN, 43: np.NaN, 44: np.NaN, 45: np.NaN, 46: np.NaN,
                                                     47: 3330000000.0},
                                              'KD': {0: np.NaN, 1: np.NaN, 2: np.NaN, 3: np.NaN, 4: np.NaN, 5: np.NaN,
                                                     6: np.NaN, 7: np.NaN, 8: np.NaN, 9: np.NaN, 10: np.NaN, 11: np.NaN,
                                                     12: np.NaN, 13: np.NaN, 14: np.NaN, 15: np.NaN, 16: np.NaN,
                                                     17: np.NaN, 18: np.NaN, 19: np.NaN, 20: np.NaN, 21: np.NaN,
                                                     22: np.NaN, 23: np.NaN, 24: np.NaN, 25: np.NaN, 26: np.NaN,
                                                     27: np.NaN, 28: np.NaN, 29: np.NaN, 30: np.NaN, 31: np.NaN,
                                                     32: np.NaN, 33: np.NaN, 34: np.NaN, 35: np.NaN, 36: np.NaN,
                                                     37: np.NaN, 38: np.NaN, 39: np.NaN, 40: np.NaN, 41: np.NaN,
                                                     42: np.NaN, 43: np.NaN, 44: np.NaN, 45: np.NaN, 46: np.NaN,
                                                     47: 1.54e-07},
                                              'Analyte 1 Solution': {0: 'BRD-6011_1', 1: 'BRD-6011_2', 2: 'BRD-6011_3',
                                                                     3: 'BRD-6011_4', 4: 'BRD-6011_5', 5: 'BRD-6011_6',
                                                                     6: 'BRD-6011_7', 7: 'BRD-6011_8', 8: 'BRD-5709_9',
                                                                     9: 'BRD-5654_10', 10: 'BRD-5726_11',
                                                                     11: 'BRD-5658_12', 12: 'BRD-5708_13',
                                                                     13: 'BRD-5681_14', 14: 'BRD-5702_15',
                                                                     15: 'BRD-5685_16', 16: 'BRD-5725_17',
                                                                     17: 'BRD-5711_18', 18: 'BRD-5728_19',
                                                                     19: 'BRD-5664_20', 20: 'BRD-5627_21',
                                                                     21: 'BRD-5669_22', 22: 'BRD-5650_23',
                                                                     23: 'BRD-5674_24', 24: 'BRD-5690_25',
                                                                     25: 'BRD-5655_26', 26: 'BRD-5694_27',
                                                                     27: 'BRD-5659_28', 28: 'BRD-4761_29',
                                                                     29: 'BRD-5683_30', 30: 'BRD-5703_31',
                                                                     31: 'BRD-5638_32', 32: 'BRD-5721_33',
                                                                     33: 'BRD-5660_34', 34: 'BRD-5718_35',
                                                                     35: 'BRD-5665_36', 36: 'BRD-5645_37',
                                                                     37: 'BRD-5669_38', 38: 'BRD-5651_39',
                                                                     39: 'BRD-5641_40', 40: 'BRD-5691_41',
                                                                     41: 'BRD-5032_42', 42: 'BRD-5737_43',
                                                                     43: 'BRD-5676_44', 44: 'BRD-5698_45',
                                                                     45: 'BRD-5682_46', 46: 'BRD-5704_47',
                                                                     47: 'BRD-5640_48'},
                                              'Cmpd_Run_Order': {0: 1, 1: 2, 2: 3, 3: 4, 4: 5, 5: 6, 6: 7, 7: 8, 8: 9,
                                                                 9: 10, 10: 11, 11: 12, 12: 13, 13: 14, 14: 15, 15: 16,
                                                                 16: 17, 17: 18, 18: 19, 19: 20, 20: 21, 21: 22, 22: 23,
                                                                 23: 24, 24: 25, 25: 26, 26: 27, 27: 28, 28: 29, 29: 30,
                                                                 30: 31, 31: 32, 32: 33, 33: 34, 34: 35, 35: 36, 36: 37,
                                                                 37: 38, 38: 39, 39: 40, 40: 41, 41: 42, 42: 43, 43: 44,
                                                                 44: 45, 45: 46, 46: 47, 47: 48},
                                              'Senso_Img': {0: 'BRD-6011_1_200212_7260_affinity_19_1.png',
                                                            1: 'BRD-6011_2_200212_7260_affinity_19_2.png',
                                                            2: 'BRD-6011_3_200212_7260_affinity_19_3.png',
                                                            3: 'BRD-6011_4_200212_7260_affinity_19_4.png',
                                                            4: 'BRD-6011_5_200212_7260_affinity_19_5.png',
                                                            5: 'BRD-6011_6_200212_7260_affinity_19_6.png',
                                                            6: 'BRD-6011_7_200212_7260_affinity_19_7.png',
                                                            7: 'BRD-6011_8_200212_7260_affinity_19_8.png',
                                                            8: 'BRD-5709_9_200212_7260_affinity_19_9.png',
                                                            9: 'BRD-5654_10_200212_7260_affinity_19_10.png',
                                                            10: 'BRD-5726_11_200212_7260_affinity_19_11.png',
                                                            11: 'BRD-5658_12_200212_7260_affinity_19_12.png',
                                                            12: 'BRD-5708_13_200212_7260_affinity_19_13.png',
                                                            13: 'BRD-5681_14_200212_7260_affinity_19_14.png',
                                                            14: 'BRD-5702_15_200212_7260_affinity_19_15.png',
                                                            15: 'BRD-5685_16_200212_7260_affinity_19_16.png',
                                                            16: 'BRD-5725_17_200212_7260_affinity_19_17.png',
                                                            17: 'BRD-5711_18_200212_7260_affinity_19_18.png',
                                                            18: 'BRD-5728_19_200212_7260_affinity_19_19.png',
                                                            19: 'BRD-5664_20_200212_7260_affinity_19_20.png',
                                                            20: 'BRD-5627_21_200212_7260_affinity_19_21.png',
                                                            21: 'BRD-5669_22_200212_7260_affinity_19_22.png',
                                                            22: 'BRD-5650_23_200212_7260_affinity_19_23.png',
                                                            23: 'BRD-5674_24_200212_7260_affinity_19_24.png',
                                                            24: 'BRD-5690_25_200212_7260_affinity_19_25.png',
                                                            25: 'BRD-5655_26_200212_7260_affinity_19_26.png',
                                                            26: 'BRD-5694_27_200212_7260_affinity_19_27.png',
                                                            27: 'BRD-5659_28_200212_7260_affinity_19_28.png',
                                                            28: 'BRD-4761_29_200212_7260_affinity_19_29.png',
                                                            29: 'BRD-5683_30_200212_7260_affinity_19_30.png',
                                                            30: 'BRD-5703_31_200212_7260_affinity_19_31.png',
                                                            31: 'BRD-5638_32_200212_7260_affinity_19_32.png',
                                                            32: 'BRD-5721_33_200212_7260_affinity_19_33.png',
                                                            33: 'BRD-5660_34_200212_7260_affinity_19_34.png',
                                                            34: 'BRD-5718_35_200212_7260_affinity_19_35.png',
                                                            35: 'BRD-5665_36_200212_7260_affinity_19_36.png',
                                                            36: 'BRD-5645_37_200212_7260_affinity_19_37.png',
                                                            37: 'BRD-5669_38_200212_7260_affinity_19_38.png',
                                                            38: 'BRD-5651_39_200212_7260_affinity_19_39.png',
                                                            39: 'BRD-5641_40_200212_7260_affinity_19_40.png',
                                                            40: 'BRD-5691_41_200212_7260_affinity_19_41.png',
                                                            41: 'BRD-5032_42_200212_7260_affinity_19_42.png',
                                                            42: 'BRD-5737_43_200212_7260_affinity_19_43.png',
                                                            43: 'BRD-5676_44_200212_7260_affinity_19_44.png',
                                                            44: 'BRD-5698_45_200212_7260_affinity_19_45.png',
                                                            45: 'BRD-5682_46_200212_7260_affinity_19_46.png',
                                                            46: 'BRD-5704_47_200212_7260_affinity_19_47.png',
                                                            47: 'BRD-5640_48_200212_7260_affinity_19_48.png',
                                                            }})

        cls.df_ru_top_result = pd.DataFrame({'Relative response (RU)': [35.83, 36.49, 36.34, 34.89, 35.17, 36.48,
                                                                        36.19, 33.92, 23.81, 20.23,
                                             63.57, 22.11, 22.66, 59.98, 53.59, 28.1, 49.93, 40.9, 75.32, 50.51, 47.63,
                                             83.6, 28.59, 36.58, 52.61, 12.46, 15.19, 16.84, 28.72, 26.97, 18.81, 30.92,
                                             28.53, 32.5, 31.72, 16.22, 26.1, 77.67, 35.74, 18.94, 24.05, 32.55, 35.72,
                                             44.11, 51.18, 63.29, 17.97]})

    @patch('script_spr_to_adlp_8k.SPR_to_ADLP_8K.spr_binding_top_for_dot_file')
    @patch('shutil.rmtree')
    @patch('shutil.copytree')
    @patch('script_spr_to_adlp_8k.SPR_to_ADLP_8K.spr_insert_images', return_value='Image Place Holder')
    @patch('script_spr_to_adlp_8k.SPR_to_ADLP_8K.rename_images')
    @patch('pandas.ExcelWriter')
    @patch('pandas.DataFrame.to_excel')
    def test_Cli_and_adlp_df_created_Biacore8k(self, mock_1, mock_2, mock_3, mock_4, mock_5, mock_6, mock_7) -> None:
        """
        Test that the final DataFrame for ADLP upload is created in memory.  Note that all methods related to writing
        the DataFrame to a file using Pandas and the xlsxwriter engine have been patched.

        :param mock_1:  Mocks the pandas.DataFrame.to_excel method
        :param mock_2: Mocks the pandas.ExcelWriter method
        :param mock_3: Mocks the rename_images method
        :param mock_4: Mocks the spr_insert_images method
        :param mock_5: Mocks shutil.copytree method used to restore image files in the event of a crash
        :param mock_6: Mocks the shutil.rmtree method used to restore image files in the event of a crash
        :param mock_7: Mocks the spr_binding_top_for_dot_file method as this is computationally expensive
        :return: None
        """

        # Define the Return value of the mocked rename_images function
        mock_3.side_effect = [SPR_to_ADLP_8K_Cli.df_ss_txt_test, SPR_to_ADLP_8K_Cli.df_senso_txt_test]

        # Define the Return value of the mocked spr_binding_top_for_dot_file function
        mock_7.side_effect = [SPR_to_ADLP_8K_Cli.df_ru_top_result]

        # Use the click CliRunner object for testing Click implemented Cli programs.
        runner = CliRunner()
        result = runner.invoke(spr_create_dot_upload_file, ['--config_file', './tests/fixtures/Biacore8k_Test_Files'
                                                                             '/200212_config_8K.txt',
                                                            '--save_file','Test.xlsx'])

        print(result.output)
        self.assertEqual(0, result.exit_code)